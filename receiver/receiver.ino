#include <SPI.h>
#include <Wire.h>
#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>

Adafruit_SSD1306 display = Adafruit_SSD1306(128, 32, &Wire);

// Burning Man map, 128x169px
const unsigned char bm_map[] PROGMEM = {
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x60, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x06, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x60, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x80, 0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x01, 0x80, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x80, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x60, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00,
    0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00,
    0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00,
    0x00, 0x00, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00,
    0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00,
    0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x00,
    0x00, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x60, 0x00,
    0x00, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00,
    0x00, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00,
    0x00, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x06, 0x00,
    0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
    0x01, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc0,
    0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20,
    0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10,
    0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0c,
    0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02,
    0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,
    0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
    0x00, 0xb0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x06, 0x80,
    0x00, 0x8c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x80,
    0x01, 0x0b, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x68, 0x40,
    0x01, 0x10, 0x80, 0x00, 0x00, 0x00, 0x00, 0x01, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x84, 0x40,
    0x02, 0x20, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x03, 0x82, 0x20,
    0x02, 0x20, 0x98, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0c, 0x82, 0x20,
    0x04, 0x21, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x42, 0x10,
    0x04, 0x41, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x70, 0x41, 0x10,
    0x08, 0x42, 0x04, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x90, 0x21, 0x08,
    0x08, 0x82, 0x08, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x06, 0x08, 0x20, 0x88,
    0x08, 0x84, 0x08, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0c, 0x08, 0x10, 0x88,
    0x11, 0x04, 0x10, 0x26, 0x00, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00, 0x32, 0x04, 0x10, 0x44,
    0x11, 0x08, 0x10, 0x41, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc1, 0x04, 0x08, 0x44,
    0x11, 0x08, 0x20, 0x40, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x81, 0x02, 0x08, 0x44,
    0x32, 0x08, 0x20, 0x41, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x06, 0x41, 0x02, 0x08, 0x26,
    0x2f, 0x10, 0x20, 0x81, 0x0c, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x18, 0x40, 0x82, 0x04, 0x7a,
    0x22, 0xf0, 0x40, 0x82, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x60, 0x20, 0x81, 0x07, 0xa2,
    0x22, 0x1e, 0x41, 0x02, 0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x20, 0x41, 0x3c, 0x22,
    0x44, 0x11, 0xc1, 0x04, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x10, 0x41, 0xc4, 0x11,
    0x44, 0x20, 0x7d, 0x04, 0x01, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x40, 0x10, 0x5f, 0x02, 0x11,
    0x44, 0x20, 0x83, 0x84, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x10, 0xe0, 0x82, 0x11,
    0x44, 0x20, 0x82, 0x78, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x0f, 0x20, 0x82, 0x11,
    0x44, 0x20, 0x82, 0x0f, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x78, 0x20, 0x82, 0x11,
    0x44, 0x20, 0x82, 0x08, 0xf4, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x17, 0x88, 0x20, 0x82, 0x11,
    0x88, 0x40, 0x82, 0x08, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x08, 0x20, 0x81, 0x08,
    0x88, 0x41, 0x04, 0x10, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x04, 0x10, 0x41, 0x08,
    0x88, 0x41, 0x04, 0x10, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x04, 0x10, 0x41, 0x08,
    0x88, 0x41, 0x04, 0x10, 0x08, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x08, 0x04, 0x10, 0x41, 0x08,
    0x88, 0x41, 0x04, 0x10, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x04, 0x10, 0x41, 0x08,
    0x88, 0x41, 0x04, 0x10, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x04, 0x10, 0x41, 0x08,
    0x88, 0x41, 0x04, 0x10, 0x08, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x08, 0x04, 0x10, 0x41, 0x08,
    0xff, 0xff, 0xff, 0xff, 0xf8, 0x88, 0x88, 0x89, 0xc8, 0x88, 0x88, 0x8f, 0xff, 0xff, 0xff, 0xff,
    0x88, 0x41, 0x04, 0x10, 0x08, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x08, 0x04, 0x10, 0x41, 0x08,
    0x88, 0x41, 0x04, 0x10, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x04, 0x10, 0x41, 0x08,
    0x88, 0x41, 0x04, 0x10, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x04, 0x10, 0x41, 0x08,
    0x88, 0x41, 0x04, 0x10, 0x08, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x08, 0x04, 0x10, 0x41, 0x08,
    0x88, 0x41, 0x04, 0x10, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x04, 0x10, 0x41, 0x08,
    0x88, 0x41, 0x04, 0x10, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x04, 0x10, 0x41, 0x08,
    0x88, 0x40, 0x82, 0x08, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x08, 0x20, 0x81, 0x08,
    0x44, 0x20, 0x82, 0x08, 0xf4, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x17, 0x88, 0x20, 0x82, 0x11,
    0x44, 0x20, 0x82, 0x0f, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x78, 0x20, 0x82, 0x11,
    0x44, 0x20, 0x82, 0x78, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x0f, 0x20, 0x82, 0x11,
    0x44, 0x20, 0x83, 0x84, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x10, 0xe0, 0x82, 0x11,
    0x44, 0x20, 0x7d, 0x04, 0x01, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x40, 0x10, 0x5f, 0x02, 0x11,
    0x44, 0x11, 0xc1, 0x04, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x10, 0x41, 0xc4, 0x11,
    0x22, 0x1e, 0x41, 0x02, 0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x20, 0x41, 0x3c, 0x22,
    0x22, 0xf0, 0x40, 0x82, 0x03, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe0, 0x20, 0x81, 0x07, 0xa2,
    0x2f, 0x10, 0x20, 0x81, 0x0c, 0x40, 0x00, 0x00, 0x80, 0x00, 0x01, 0x18, 0x40, 0x82, 0x04, 0x7a,
    0x32, 0x08, 0x20, 0x41, 0x30, 0x20, 0x00, 0x00, 0x00, 0x00, 0x02, 0x06, 0x41, 0x02, 0x08, 0x26,
    0x11, 0x08, 0x20, 0x40, 0xc0, 0x10, 0x00, 0x00, 0x00, 0x00, 0x04, 0x01, 0x81, 0x02, 0x08, 0x44,
    0x11, 0x08, 0x10, 0x41, 0x80, 0x08, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0xc1, 0x04, 0x08, 0x44,
    0x11, 0x04, 0x10, 0x26, 0x40, 0x0c, 0x00, 0x00, 0x80, 0x00, 0x18, 0x01, 0x32, 0x04, 0x10, 0x44,
    0x08, 0x84, 0x08, 0x18, 0x20, 0x12, 0x00, 0x00, 0x00, 0x00, 0x24, 0x02, 0x0c, 0x08, 0x10, 0x88,
    0x08, 0x82, 0x08, 0x30, 0x20, 0x21, 0x00, 0x00, 0x00, 0x00, 0x42, 0x02, 0x06, 0x08, 0x20, 0x88,
    0x08, 0x42, 0x04, 0xc8, 0x10, 0x40, 0x80, 0x00, 0x00, 0x00, 0x81, 0x04, 0x09, 0x90, 0x21, 0x08,
    0x04, 0x41, 0x07, 0x08, 0x08, 0x80, 0x60, 0x00, 0x80, 0x03, 0x00, 0x88, 0x08, 0x70, 0x41, 0x10,
    0x04, 0x21, 0x06, 0x04, 0x05, 0x00, 0x58, 0x03, 0xe0, 0x0d, 0x00, 0x50, 0x10, 0x30, 0x42, 0x10,
    0x02, 0x20, 0x99, 0x02, 0x02, 0x00, 0x47, 0x0c, 0x18, 0x71, 0x00, 0x20, 0x20, 0x4c, 0x82, 0x20,
    0x02, 0x20, 0xe1, 0x01, 0x05, 0x00, 0x80, 0xf0, 0x07, 0x80, 0x80, 0x50, 0x40, 0x43, 0x82, 0x20,
    0x01, 0x10, 0xc0, 0x80, 0x88, 0x80, 0x80, 0x40, 0x01, 0x00, 0x80, 0x88, 0x80, 0x81, 0x84, 0x40,
    0x01, 0x0b, 0x40, 0x40, 0x90, 0x41, 0x00, 0x40, 0x01, 0x00, 0x41, 0x04, 0x81, 0x01, 0x68, 0x40,
    0x00, 0x8c, 0x20, 0x40, 0x60, 0x31, 0x00, 0x80, 0x00, 0x80, 0x46, 0x03, 0x01, 0x02, 0x18, 0x80,
    0x00, 0xb4, 0x10, 0x20, 0x60, 0x0a, 0x00, 0x80, 0x00, 0x80, 0x28, 0x03, 0x02, 0x04, 0x16, 0x80,
    0x00, 0x44, 0x10, 0x10, 0x98, 0x06, 0x01, 0x00, 0x00, 0x40, 0x30, 0x0c, 0x84, 0x04, 0x11, 0x00,
    0x00, 0x42, 0x08, 0x09, 0x04, 0x05, 0x81, 0x00, 0x00, 0x40, 0xd0, 0x10, 0x48, 0x08, 0x21, 0x00,
    0x00, 0x21, 0x04, 0x06, 0x02, 0x08, 0x61, 0x00, 0x00, 0x43, 0x08, 0x20, 0x30, 0x10, 0x42, 0x00,
    0x00, 0x11, 0x02, 0x06, 0x01, 0x08, 0x1d, 0x00, 0x00, 0x5c, 0x08, 0x40, 0x30, 0x20, 0x44, 0x00,
    0x00, 0x10, 0x81, 0x09, 0x00, 0xd0, 0x03, 0x00, 0x00, 0x60, 0x05, 0x80, 0x48, 0x40, 0x84, 0x00,
    0x00, 0x08, 0x41, 0x10, 0x80, 0x30, 0x02, 0x80, 0x00, 0xa0, 0x06, 0x00, 0x84, 0x41, 0x08, 0x00,
    0x00, 0x04, 0x20, 0xa0, 0x40, 0x28, 0x02, 0x80, 0x00, 0xa0, 0x0a, 0x01, 0x02, 0x82, 0x10, 0x00,
    0x00, 0x04, 0x10, 0x40, 0x30, 0x47, 0x02, 0x40, 0x01, 0x20, 0x71, 0x06, 0x01, 0x04, 0x10, 0x00,
    0x00, 0x02, 0x10, 0xa0, 0x08, 0x40, 0xc4, 0x40, 0x01, 0x11, 0x81, 0x08, 0x02, 0x84, 0x20, 0x00,
    0x00, 0x01, 0x09, 0x18, 0x06, 0x80, 0x3c, 0x30, 0x06, 0x1e, 0x00, 0xb0, 0x0c, 0x48, 0x40, 0x00,
    0x00, 0x00, 0x86, 0x04, 0x01, 0x80, 0x07, 0xcc, 0x19, 0xf0, 0x00, 0xc0, 0x10, 0x30, 0x80, 0x00,
    0x00, 0x00, 0x46, 0x02, 0x01, 0xc0, 0x08, 0x3b, 0xee, 0x08, 0x01, 0xc0, 0x20, 0x31, 0x00, 0x00,
    0x00, 0x00, 0x29, 0x01, 0x02, 0x30, 0x08, 0x00, 0x80, 0x08, 0x06, 0x20, 0x40, 0x4a, 0x00, 0x00,
    0x00, 0x00, 0x10, 0xc0, 0xc2, 0x0c, 0x08, 0x00, 0x80, 0x08, 0x18, 0x21, 0x81, 0x84, 0x00, 0x00,
    0x80, 0x00, 0x08, 0x20, 0x24, 0x03, 0x88, 0x00, 0x80, 0x08, 0xe0, 0x12, 0x02, 0x08, 0x00, 0x00,
    0x80, 0x00, 0x04, 0x10, 0x1c, 0x00, 0x78, 0x00, 0x80, 0x0f, 0x00, 0x1c, 0x04, 0x10, 0x00, 0x00,
    0x80, 0x00, 0x02, 0x08, 0x0e, 0x00, 0x17, 0xc0, 0x81, 0xf4, 0x00, 0x38, 0x08, 0x20, 0x00, 0x00,
    0x40, 0x00, 0x01, 0x06, 0x11, 0x80, 0x10, 0x3f, 0xfe, 0x04, 0x00, 0xc4, 0x30, 0x40, 0x00, 0x01,
    0x40, 0x00, 0x00, 0x81, 0x10, 0x60, 0x20, 0x00, 0x80, 0x02, 0x03, 0x04, 0x40, 0x80, 0x00, 0x01,
    0x40, 0x00, 0x00, 0x60, 0xe0, 0x18, 0x20, 0x00, 0x80, 0x02, 0x0c, 0x03, 0x83, 0x00, 0x00, 0x01,
    0x20, 0x00, 0x00, 0x10, 0x30, 0x07, 0x20, 0x00, 0x80, 0x02, 0x70, 0x06, 0x04, 0x00, 0x00, 0x02,
    0x20, 0x00, 0x00, 0x0c, 0x48, 0x00, 0xf0, 0x00, 0x80, 0x07, 0x80, 0x09, 0x18, 0x00, 0x00, 0x02,
    0x20, 0x00, 0x00, 0x02, 0x47, 0x00, 0x4f, 0x80, 0x80, 0xf9, 0x00, 0x71, 0x20, 0x00, 0x00, 0x02,
    0x10, 0x00, 0x00, 0x01, 0x80, 0xc0, 0x40, 0x7f, 0xff, 0x01, 0x01, 0x80, 0xc0, 0x00, 0x00, 0x04,
    0x10, 0x00, 0x00, 0x00, 0x60, 0x30, 0x40, 0x00, 0x80, 0x01, 0x06, 0x03, 0x00, 0x00, 0x00, 0x04,
    0x10, 0x00, 0x00, 0x00, 0x18, 0x0e, 0x80, 0x00, 0x80, 0x00, 0xb8, 0x0c, 0x00, 0x00, 0x00, 0x04,
    0x08, 0x00, 0x00, 0x00, 0x06, 0x01, 0xe0, 0x00, 0x80, 0x03, 0xc0, 0x30, 0x00, 0x00, 0x00, 0x08,
    0x08, 0x00, 0x00, 0x00, 0x01, 0x80, 0x9f, 0x80, 0x80, 0xfc, 0x80, 0xc0, 0x00, 0x00, 0x00, 0x08,
    0x08, 0x00, 0x00, 0x00, 0x00, 0x70, 0x80, 0x7f, 0xff, 0x00, 0x87, 0x00, 0x00, 0x00, 0x00, 0x08,
    0x04, 0x00, 0x00, 0x00, 0x00, 0x0f, 0x00, 0x00, 0x80, 0x00, 0x78, 0x00, 0x00, 0x00, 0x00, 0x10,
    0x04, 0x00, 0x00, 0x00, 0x00, 0x01, 0xe0, 0x00, 0x80, 0x03, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x10,
    0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1f, 0x80, 0x80, 0xfc, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10,
    0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7f, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20,
    0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20,
    0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20,
    0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20,
    0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40,
    0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40,
    0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40,
    0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80,
    0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80,
    0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80,
    0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
    0x00, 0x7f, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00
};

// arrow icons, 8x8px
const unsigned char up_arrow [] PROGMEM = { 0x10, 0x38, 0x7c, 0xfe, 0x38, 0x38, 0x38, 0x38 };
const unsigned char dn_arrow [] PROGMEM = { 0x38, 0x38, 0x38, 0x38, 0xfe, 0x7c, 0x38, 0x10 };


#define BUTTON_A  9
#define BUTTON_B  6
#define BUTTON_C  5

#define MAP_HEIGHT     (sizeof(bm_map) / 16)
#define SCREEN_HEIGHT  32
#define SCROLL_SPEED   4  // How many pixels we scroll the map on each button press
#define MAN_X          64
#define MAN_Y          76

int y_pos = 76;
unsigned long time = 0;

void setup() {
  Serial.begin(9600);
  Serial.println("Track The Chariot!");

  pinMode(BUTTON_A, INPUT_PULLUP);
  pinMode(BUTTON_B, INPUT_PULLUP);
  pinMode(BUTTON_C, INPUT_PULLUP);

  display.begin(SSD1306_SWITCHCAPVCC, 0x3C); // Address 0x3C for 128x32

  display.clearDisplay();
  display.setTextSize(1);
  display.setTextColor(WHITE);
  display.setCursor(0, 0);
  //display.println("Hello world");
  display.display();
}


/**
 * Draws an animated circle at pixel coordinates (x, y)
 * If the circle would not be visible (because the screen is scrolled too far up or down)
 * draw a blinking arrow instead
 */
void drawTarget(int x, int y) {
  // Take the time in milliseconds, modulo 512. This is used for the animation.
  int t = 512 - (millis() % 512);

  if (y_pos > y + 7) {
    // Target is too high, draw a blinking up arrow
    if (t > 256) { display.drawBitmap(61, 0, up_arrow, 8, 8, WHITE); }
  } else if (y_pos + SCREEN_HEIGHT < y - 7) {
    // Target is too low, draw a blinking down arrow
    if (t > 256) { display.drawBitmap(61, SCREEN_HEIGHT - 8, dn_arrow, 8, 8, WHITE); }
  } else {
    // Draw 2 animated circles converging to the target
    display.drawCircle(x, y - y_pos, t / 32, WHITE);
    display.drawCircle(x, y - y_pos, t / 64, WHITE);
  }
}

void loop() {
  time = millis();
  if (!digitalRead(BUTTON_A)) {
    y_pos = max(y_pos - SCROLL_SPEED, 0);
  }
  if (!digitalRead(BUTTON_C)) {
    y_pos = min(y_pos + SCROLL_SPEED, MAP_HEIGHT - 32);
  }

  if (!digitalRead(BUTTON_B)) {
  }

  display.clearDisplay();
  display.drawBitmap(0, 0, bm_map + y_pos * 16, 128, 32, WHITE);

  drawTarget(64, 50);

  display.display();
  delay(1);
}
